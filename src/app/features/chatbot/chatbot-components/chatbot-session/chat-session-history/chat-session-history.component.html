<div class="h-full w-full relative">
  <div
    #chatHistoryContainer
    cdkScrollable
    (scroll)="onScroll()"
    class="h-full w-full p-4 flex flex-col overflow-y-auto
    sb-bg-transparent sb-th-primary sb-h-accent scroll-pr-2">
  
    @if (session()) {
      @for (msg of session()?.messages; track $index) {
        @if (msg.role === 'user') {
          <app-chat-session-message-user
            [chatMessage]="msg"
          ></app-chat-session-message-user>
        }
        @else {
          <app-chat-session-message-assistant
            [chatMessage]="msg"
          ></app-chat-session-message-assistant>
        }
      }
    }
  </div>
  
  @if (!isAtBottom) {
    <div class="absolute bottom-4 p-4 flex center">
      <button
        (click)="scrollToBottom()"
        class="p-2 rounded-full bg-secondary text-primary hover:bg-accent hover:text-secondary shadow-lg"
        aria-label="Scroll to bottom"
      >
        <svg class="w-6 h-6" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19V5m0 14-4-4m4 4 4-4"/>
        </svg>
      </button>
    </div>
  }
</div>
